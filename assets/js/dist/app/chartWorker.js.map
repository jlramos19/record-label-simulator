{"version":3,"file":"chartWorker.js","sourceRoot":"","sources":["../../../../src/app/chartWorker.ts"],"names":[],"mappings":"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","sourcesContent":["/// <reference lib=\"webworker\" />\nimport { storeChartSnapshot } from \"./db.js\";\n\nconst workerScope = self;\nconst FALLBACK_WEIGHTS = { sales: 0.35, streaming: 0.2, airplay: 0.3, social: 0.15 };\nconst FALLBACK_VOLUME_MULTIPLIERS = { sales: 1, streaming: 5, airplay: 1, social: 1 };\nconst AUDIENCE_CHUNK = 1000;\nconst ALIGNMENTS = [\"Safe\", \"Neutral\", \"Risky\"];\nconst AUDIENCE_ALIGNMENT_SCORE_SCALE = 42;\nconst AUDIENCE_TREND_BONUS = 4;\nconst HOMELAND_ACT_BONUS = 4;\nconst HOMELAND_CREATOR_BONUS = 1;\nconst HOMELAND_CREATOR_BONUS_CAP = 6;\nconst INTERNATIONAL_RELATION_CAP = 4;\nconst COUNTRY_RELATION_BIAS = {\n  Annglora: { Bytenza: -2, Crowlya: 2 },\n  Bytenza: { Annglora: -2, Crowlya: 0 },\n  Crowlya: { Annglora: 2, Bytenza: 0 }\n};\nconst rand = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min;\n\nfunction normalizeChartWeights(weights, fallback) {\n  const safe = weights || fallback || FALLBACK_WEIGHTS;\n  const total =\n    Math.max(0, safe.sales || 0)\n    + Math.max(0, safe.streaming || 0)\n    + Math.max(0, safe.airplay || 0)\n    + Math.max(0, safe.social || 0);\n  const base = fallback || FALLBACK_WEIGHTS;\n  if (!total) return { ...base };\n  return {\n    sales: Math.max(0, safe.sales || 0) / total,\n    streaming: Math.max(0, safe.streaming || 0) / total,\n    airplay: Math.max(0, safe.airplay || 0) / total,\n    social: Math.max(0, safe.social || 0) / total\n  };\n}\n\nfunction roundToAudienceChunk(value) {\n  return Math.ceil(Math.max(0, value) / AUDIENCE_CHUNK) * AUDIENCE_CHUNK;\n}\n\nfunction buildChartMetrics(score, weights, fallback, volumeMultipliers) {\n  const normalized = normalizeChartWeights(weights, fallback);\n  const base = Math.max(0, score) * 1200;\n  const multipliers = volumeMultipliers || FALLBACK_VOLUME_MULTIPLIERS;\n  const salesMultiplier = Number.isFinite(multipliers.sales) ? multipliers.sales : 1;\n  const streamingMultiplier = Number.isFinite(multipliers.streaming) ? multipliers.streaming : 1;\n  const airplayMultiplier = Number.isFinite(multipliers.airplay) ? multipliers.airplay : 1;\n  const socialMultiplier = Number.isFinite(multipliers.social) ? multipliers.social : 1;\n  return {\n    sales: roundToAudienceChunk(base * normalized.sales * salesMultiplier),\n    streaming: roundToAudienceChunk(base * normalized.streaming * streamingMultiplier),\n    airplay: roundToAudienceChunk(base * normalized.airplay * airplayMultiplier),\n    social: roundToAudienceChunk(base * normalized.social * socialMultiplier)\n  };\n}\n\nfunction resolveAudienceProfile(scopeId, profiles, audience) {\n  const nationProfiles = profiles?.nations || {};\n  const regionProfiles = profiles?.regions || {};\n  const fallback = nationProfiles.Annglora || { alignment: \"\", theme: \"\", moods: [] };\n  const base = regionProfiles[scopeId] || nationProfiles[scopeId] || fallback;\n  const bias = audience?.regions?.[scopeId] || audience?.nations?.[scopeId] || null;\n  if (bias) {\n    return {\n      alignmentWeights: bias.alignmentWeights || null,\n      themes: Array.isArray(bias.themes) && bias.themes.length ? bias.themes : [base.theme],\n      moods: Array.isArray(bias.moods) && bias.moods.length ? bias.moods : base.moods || [],\n      trendGenres: Array.isArray(bias.trendGenres) ? bias.trendGenres : []\n    };\n  }\n  return {\n    alignment: base.alignment,\n    themes: [base.theme],\n    moods: base.moods || [],\n    trendGenres: []\n  };\n}\n\nfunction resolveScopeNation(scopeId, regionDefs, nations) {\n  if (!scopeId || scopeId === \"global\") return null;\n  if (Array.isArray(nations) && nations.includes(scopeId)) return scopeId;\n  const region = Array.isArray(regionDefs) ? regionDefs.find((entry) => entry.id === scopeId) : null;\n  return region ? region.nation : null;\n}\n\nfunction resolveTrackOriginMeta(track) {\n  if (!track) return { actCountry: null, creatorCountries: [], originCountries: [] };\n  const creatorCountries = Array.isArray(track.creatorCountries)\n    ? track.creatorCountries.filter(Boolean)\n    : [];\n  const actCountry = track.actCountry || null;\n  const fallback = track.country || null;\n  const originCountries = Array.from(new Set([actCountry, ...creatorCountries, fallback].filter(Boolean)));\n  return { actCountry: actCountry || fallback, creatorCountries, originCountries };\n}\n\nfunction homelandBonusForScope(originMeta, scopeNation) {\n  if (!originMeta || !scopeNation) return 0;\n  let bonus = 0;\n  if (originMeta.actCountry === scopeNation) bonus += HOMELAND_ACT_BONUS;\n  const creatorMatches = originMeta.creatorCountries.filter((country) => country === scopeNation).length;\n  if (creatorMatches) {\n    bonus += Math.min(HOMELAND_CREATOR_BONUS_CAP, creatorMatches * HOMELAND_CREATOR_BONUS);\n  }\n  return bonus;\n}\n\nfunction internationalBiasForScope(originMeta, scopeNation) {\n  if (!originMeta || !scopeNation) return 0;\n  const foreignOrigins = originMeta.originCountries.filter((country) => country && country !== scopeNation);\n  if (!foreignOrigins.length) return 0;\n  const total = foreignOrigins.reduce((sum, country) => {\n    const bias = COUNTRY_RELATION_BIAS?.[scopeNation]?.[country];\n    return sum + (Number.isFinite(bias) ? bias : 0);\n  }, 0);\n  if (!Number.isFinite(total) || !total) return 0;\n  return Math.max(-INTERNATIONAL_RELATION_CAP, Math.min(INTERNATIONAL_RELATION_CAP, total));\n}\n\nfunction scoreTrack(track, regionName, profiles, trends, audience, labelCompetition, regionDefs, nations) {\n  const nationProfiles = profiles?.nations || {};\n  const regionProfiles = profiles?.regions || {};\n  const fallback = nationProfiles.Annglora || { alignment: \"\", theme: \"\", moods: [] };\n  const region = regionProfiles[regionName] || nationProfiles[regionName] || fallback;\n  const audienceProfile = resolveAudienceProfile(regionName, profiles, audience);\n  let score = track.quality || 0;\n  if (audienceProfile.alignmentWeights) {\n    const alignment = ALIGNMENTS.includes(track.alignment) ? track.alignment : \"Neutral\";\n    const alignmentWeight = Number(audienceProfile.alignmentWeights?.[alignment]);\n    const baseline = 1 / ALIGNMENTS.length;\n    const delta = Number.isFinite(alignmentWeight) ? alignmentWeight - baseline : 0;\n    score += Math.round(delta * AUDIENCE_ALIGNMENT_SCORE_SCALE);\n  } else {\n    score += track.alignment === region.alignment ? 12 : -6;\n  }\n  if (Array.isArray(audienceProfile.themes) && audienceProfile.themes.includes(track.theme)) score += 8;\n  if (Array.isArray(audienceProfile.moods) && audienceProfile.moods.includes(track.mood)) score += 6;\n  if (Array.isArray(audienceProfile.trendGenres) && audienceProfile.trendGenres.includes(track.genre)) {\n    score += AUDIENCE_TREND_BONUS;\n  }\n  score += Array.isArray(trends) && trends.includes(track.genre) ? 10 : 0;\n  score += track.promoWeeks > 0 ? 10 : 0;\n  const promoGapPenalty = Number.isFinite(track?.promoGapPenalty) ? track.promoGapPenalty : 0;\n  const actStalePenalty = Number.isFinite(track?.actPromoStalePenalty) ? track.actPromoStalePenalty : 0;\n  if (promoGapPenalty || actStalePenalty) score -= promoGapPenalty + actStalePenalty;\n  const scopeNation = resolveScopeNation(regionName, regionDefs, nations);\n  if (scopeNation) {\n    const originMeta = resolveTrackOriginMeta(track);\n    score += homelandBonusForScope(originMeta, scopeNation);\n    score += internationalBiasForScope(originMeta, scopeNation);\n  }\n  score += rand(-4, 4);\n  const competitionMultiplier = Number.isFinite(labelCompetition?.[track.label]) ? labelCompetition[track.label] : 1;\n  if (competitionMultiplier !== 1) score = Math.round(score * competitionMultiplier);\n  const decay = Math.max(0.4, 1 - (track.weeksOnChart || 0) * 0.05);\n  return Math.round(score * decay);\n}\n\nfunction computeCharts(payload) {\n  const tracks = Array.isArray(payload?.tracks) ? payload.tracks : [];\n  const nations = Array.isArray(payload?.nations) ? payload.nations : [];\n  const regionIds = Array.isArray(payload?.regionIds) ? payload.regionIds : [];\n  const regionDefs = Array.isArray(payload?.regionDefs) ? payload.regionDefs : [];\n  const chartSizes = payload?.chartSizes || { global: 0, nation: 0, region: 0 };\n  const weights = payload?.weights || {};\n  const defaultWeights = payload?.defaultWeights || FALLBACK_WEIGHTS;\n  const volumeMultipliers = payload?.volumeMultipliers || FALLBACK_VOLUME_MULTIPLIERS;\n  const profiles = payload?.profiles || {};\n  const trends = payload?.trends || [];\n  const audience = payload?.audience || {};\n  const labelCompetition = payload?.labelCompetition || {};\n\n  const nationScores = {};\n  const regionScores = {};\n  nations.forEach((nation) => {\n    nationScores[nation] = [];\n  });\n  regionIds.forEach((regionId) => {\n    regionScores[regionId] = [];\n  });\n  const globalScores = [];\n\n  tracks.forEach((track) => {\n    let sum = 0;\n    nations.forEach((nation) => {\n      const score = scoreTrack(track, nation, profiles, trends, audience, labelCompetition, regionDefs, nations);\n      const metrics = buildChartMetrics(score, weights?.nations?.[nation], defaultWeights, volumeMultipliers);\n      nationScores[nation].push({ key: track.key, score, metrics });\n      sum += score;\n    });\n    const avg = nations.length ? Math.round(sum / nations.length) : 0;\n    globalScores.push({\n      key: track.key,\n      score: avg,\n      metrics: buildChartMetrics(avg, weights?.global, defaultWeights, volumeMultipliers)\n    });\n    regionIds.forEach((regionId) => {\n      const score = scoreTrack(track, regionId, profiles, trends, audience, labelCompetition, regionDefs, nations);\n      const metrics = buildChartMetrics(score, weights?.regions?.[regionId], defaultWeights, volumeMultipliers);\n      regionScores[regionId].push({ key: track.key, score, metrics });\n    });\n  });\n\n  globalScores.sort((a, b) => b.score - a.score);\n  const charts = {\n    global: globalScores.slice(0, chartSizes.global),\n    nations: {},\n    regions: {}\n  };\n\n  nations.forEach((nation) => {\n    charts.nations[nation] = nationScores[nation]\n      .sort((a, b) => b.score - a.score)\n      .slice(0, chartSizes.nation);\n  });\n  regionIds.forEach((regionId) => {\n    charts.regions[regionId] = regionScores[regionId]\n      .sort((a, b) => b.score - a.score)\n      .slice(0, chartSizes.region);\n  });\n\n  return { charts, globalScores };\n}\n\nasync function persistSnapshots(snapshots) {\n  if (!Array.isArray(snapshots) || !snapshots.length) return { stored: 0, total: 0 };\n  const results = await Promise.allSettled(snapshots.map((snapshot) => storeChartSnapshot(snapshot)));\n  const stored = results.filter((result) => result.status === \"fulfilled\").length;\n  return { stored, total: snapshots.length };\n}\n\nworkerScope.addEventListener(\"message\", async (event) => {\n  const message = event?.data || {};\n  if (!message || !message.type || typeof message.id !== \"number\") return;\n  if (message.type === \"computeCharts\") {\n    const payload = computeCharts(message.payload);\n    workerScope.postMessage({ type: \"chartsComputed\", id: message.id, payload });\n    return;\n  }\n  if (message.type === \"persistSnapshots\") {\n    const payload = await persistSnapshots(message.payload?.snapshots);\n    workerScope.postMessage({ type: \"snapshotsPersisted\", id: message.id, payload });\n  }\n});\n"]}