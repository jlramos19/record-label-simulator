{"version":3,"file":"act-name-renderer.js","sourceRoot":"","sources":["../../../../../../src/app/game/names/act-name-renderer.ts"],"names":[],"mappings":"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","sourcesContent":["import { ACT_NAME_ADJECTIVES, ACT_NAME_NOUNS, romanizeHangul } from \"./act-name-pools.js\";\r\nimport { ActKind, parseActNameKey } from \"./act-name-generator.js\";\r\n\r\nconst HANGUL_REGEX = /[\\uac00-\\ud7a3]/;\r\n\r\nexport const hasHangulText = (value: string) => HANGUL_REGEX.test(String(value || \"\"));\r\n\r\nconst joinParts = (parts: Array<string | null | undefined>) =>\r\n  parts.filter(Boolean).join(\" \").replace(/\\s+/g, \" \").trim();\r\n\r\nconst normalizeActKind = (actKind?: ActKind | string): ActKind =>\r\n  (actKind === \"solo\" ? \"solo\" : \"group\");\r\n\r\nconst resolveActNameParts = (nameKey: string) => {\r\n  const parsed = parseActNameKey(nameKey);\r\n  if (!parsed) return null;\r\n  const adjective = ACT_NAME_ADJECTIVES[parsed.adjectiveId];\r\n  const noun = ACT_NAME_NOUNS[parsed.nounId];\r\n  if (!adjective || !noun) return null;\r\n  return { adjective, noun };\r\n};\r\n\r\nconst resolveSpanishAdjective = (adjective, nounGender: \"m\" | \"f\", actKind: ActKind) => {\r\n  if (actKind === \"solo\") return nounGender === \"f\" ? adjective.es_f_s : adjective.es_m_s;\r\n  return nounGender === \"f\" ? adjective.es_f_p : adjective.es_m_p;\r\n};\r\n\r\nexport const renderActNameEnglish = (nameKey: string, actKind: ActKind = \"group\") => {\r\n  const parts = resolveActNameParts(nameKey);\r\n  if (!parts) return \"\";\r\n  const noun = actKind === \"solo\" ? parts.noun.en.s : parts.noun.en.p;\r\n  return joinParts([parts.adjective.en, noun]);\r\n};\r\n\r\nexport const renderActNameSpanish = (nameKey: string, actKind: ActKind = \"group\") => {\r\n  const parts = resolveActNameParts(nameKey);\r\n  if (!parts) return \"\";\r\n  const gender = parts.noun.es.gender === \"f\" ? \"f\" : \"m\";\r\n  const noun = actKind === \"solo\" ? parts.noun.es.s : parts.noun.es.p;\r\n  const adjective = resolveSpanishAdjective(parts.adjective, gender, actKind);\r\n  return joinParts([noun, adjective]);\r\n};\r\n\r\nexport const renderActNameKorean = (nameKey: string, actKind: ActKind = \"group\") => {\r\n  const parts = resolveActNameParts(nameKey);\r\n  if (!parts) return \"\";\r\n  const noun = actKind === \"solo\" ? parts.noun.ko.s.hangul : parts.noun.ko.p.hangul;\r\n  return joinParts([parts.adjective.ko.hangul, noun]);\r\n};\r\n\r\nexport const renderActNameKoreanRomanized = (nameKey: string, actKind: ActKind = \"group\") => {\r\n  const parts = resolveActNameParts(nameKey);\r\n  if (!parts) return \"\";\r\n  const noun = actKind === \"solo\" ? parts.noun.ko.s.rr : parts.noun.ko.p.rr;\r\n  return joinParts([parts.adjective.ko.rr, noun]);\r\n};\r\n\r\nexport const renderActNameByNation = (\r\n  nameKey: string,\r\n  nation = \"Annglora\",\r\n  actKind: ActKind = \"group\"\r\n) => {\r\n  if (nation === \"Bytenza\") return renderActNameKorean(nameKey, actKind);\r\n  if (nation === \"Crowlya\") return renderActNameSpanish(nameKey, actKind);\r\n  return renderActNameEnglish(nameKey, actKind);\r\n};\r\n\r\nexport const getActNameTranslation = (nameKey: string, actKind: ActKind = \"group\") =>\r\n  renderActNameEnglish(nameKey, actKind);\r\n\r\ntype ActNameLookup = {\r\n  translation: string;\r\n  romanized: string;\r\n};\r\n\r\nconst buildActNameLookup = () => {\r\n  const adjectives = Object.values(ACT_NAME_ADJECTIVES);\r\n  const nouns = Object.values(ACT_NAME_NOUNS);\r\n  const group = new Map<string, ActNameLookup>();\r\n  const solo = new Map<string, ActNameLookup>();\r\n  adjectives.forEach((adjective) => {\r\n    nouns.forEach((noun) => {\r\n      const groupName = joinParts([adjective.ko.hangul, noun.ko.p.hangul]);\r\n      if (!group.has(groupName)) {\r\n        group.set(groupName, {\r\n          translation: joinParts([adjective.en, noun.en.p]),\r\n          romanized: joinParts([adjective.ko.rr, noun.ko.p.rr])\r\n        });\r\n      }\r\n      const soloName = joinParts([adjective.ko.hangul, noun.ko.s.hangul]);\r\n      if (!solo.has(soloName)) {\r\n        solo.set(soloName, {\r\n          translation: joinParts([adjective.en, noun.en.s]),\r\n          romanized: joinParts([adjective.ko.rr, noun.ko.s.rr])\r\n        });\r\n      }\r\n    });\r\n  });\r\n  return { group, solo };\r\n};\r\n\r\nconst ACT_NAME_LOOKUP = buildActNameLookup();\r\n\r\nexport const lookupActNameDetails = ({\r\n  name,\r\n  nameKey,\r\n  actKind\r\n}: {\r\n  name: string;\r\n  nameKey?: string | null;\r\n  actKind?: ActKind | string;\r\n}) => {\r\n  const raw = String(name || \"\").trim();\r\n  if (!raw || !hasHangulText(raw)) {\r\n    return { translation: \"\", romanized: \"\" };\r\n  }\r\n  const hintKind = normalizeActKind(actKind);\r\n  let resolvedKind = hintKind;\r\n  if (nameKey) {\r\n    if (actKind == null) {\r\n      const normalizedRaw = raw.replace(/\\s+/g, \" \").trim();\r\n      const soloName = renderActNameKorean(nameKey, \"solo\");\r\n      const groupName = renderActNameKorean(nameKey, \"group\");\r\n      if (normalizedRaw === soloName) {\r\n        resolvedKind = \"solo\";\r\n      } else if (normalizedRaw === groupName) {\r\n        resolvedKind = \"group\";\r\n      }\r\n    }\r\n    const translation = renderActNameEnglish(nameKey, resolvedKind);\r\n    const romanized = renderActNameKoreanRomanized(nameKey, resolvedKind);\r\n    return { translation, romanized };\r\n  }\r\n  const lookup = resolvedKind === \"solo\" ? ACT_NAME_LOOKUP.solo : ACT_NAME_LOOKUP.group;\r\n  const fallback = resolvedKind === \"solo\" ? ACT_NAME_LOOKUP.group : ACT_NAME_LOOKUP.solo;\r\n  const entry = lookup.get(raw) || fallback.get(raw);\r\n  if (entry) return entry;\r\n  return { translation: \"\", romanized: romanizeHangul(raw) };\r\n};\r\n"]}