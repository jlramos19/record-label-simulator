{"version":3,"file":"act-name-renderer.js","sourceRoot":"","sources":["../../../../../../src/app/game/names/act-name-renderer.ts"],"names":[],"mappings":"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","sourcesContent":["import { ACT_NAME_ADJECTIVES, ACT_NAME_NOUNS, romanizeHangul } from \"./act-name-pools.js\";\nimport { ActKind, parseActNameKey } from \"./act-name-generator.js\";\n\nconst HANGUL_REGEX = /[\\uac00-\\ud7a3]/;\n\nexport const hasHangulText = (value: string) => HANGUL_REGEX.test(String(value || \"\"));\n\nconst joinParts = (parts: Array<string | null | undefined>) =>\n  parts.filter(Boolean).join(\" \").replace(/\\s+/g, \" \").trim();\n\nconst normalizeActKind = (actKind?: ActKind | string): ActKind =>\n  (actKind === \"solo\" ? \"solo\" : \"group\");\n\nconst resolveActNameParts = (nameKey: string) => {\n  const parsed = parseActNameKey(nameKey);\n  if (!parsed) return null;\n  const adjective = ACT_NAME_ADJECTIVES[parsed.adjectiveId];\n  const noun = ACT_NAME_NOUNS[parsed.nounId];\n  if (!adjective || !noun) return null;\n  return { adjective, noun };\n};\n\nconst resolveSpanishAdjective = (adjective, nounGender: \"m\" | \"f\", actKind: ActKind) => {\n  if (actKind === \"solo\") return nounGender === \"f\" ? adjective.es_f_s : adjective.es_m_s;\n  return nounGender === \"f\" ? adjective.es_f_p : adjective.es_m_p;\n};\n\nexport const renderActNameEnglish = (nameKey: string, actKind: ActKind = \"group\") => {\n  const parts = resolveActNameParts(nameKey);\n  if (!parts) return \"\";\n  const noun = actKind === \"solo\" ? parts.noun.en.s : parts.noun.en.p;\n  return joinParts([parts.adjective.en, noun]);\n};\n\nexport const renderActNameSpanish = (nameKey: string, actKind: ActKind = \"group\") => {\n  const parts = resolveActNameParts(nameKey);\n  if (!parts) return \"\";\n  const gender = parts.noun.es.gender === \"f\" ? \"f\" : \"m\";\n  const noun = actKind === \"solo\" ? parts.noun.es.s : parts.noun.es.p;\n  const adjective = resolveSpanishAdjective(parts.adjective, gender, actKind);\n  return joinParts([noun, adjective]);\n};\n\nexport const renderActNameKorean = (nameKey: string, actKind: ActKind = \"group\") => {\n  const parts = resolveActNameParts(nameKey);\n  if (!parts) return \"\";\n  const noun = actKind === \"solo\" ? parts.noun.ko.s.hangul : parts.noun.ko.p.hangul;\n  return joinParts([parts.adjective.ko.hangul, noun]);\n};\n\nexport const renderActNameKoreanRomanized = (nameKey: string, actKind: ActKind = \"group\") => {\n  const parts = resolveActNameParts(nameKey);\n  if (!parts) return \"\";\n  const noun = actKind === \"solo\" ? parts.noun.ko.s.rr : parts.noun.ko.p.rr;\n  return joinParts([parts.adjective.ko.rr, noun]);\n};\n\nexport const renderActNameByNation = (\n  nameKey: string,\n  nation = \"Annglora\",\n  actKind: ActKind = \"group\"\n) => {\n  if (nation === \"Bytenza\") return renderActNameKorean(nameKey, actKind);\n  if (nation === \"Crowlya\") return renderActNameSpanish(nameKey, actKind);\n  return renderActNameEnglish(nameKey, actKind);\n};\n\nexport const getActNameTranslation = (nameKey: string, actKind: ActKind = \"group\") =>\n  renderActNameEnglish(nameKey, actKind);\n\ntype ActNameLookup = {\n  translation: string;\n  romanized: string;\n};\n\nconst buildActNameLookup = () => {\n  const adjectives = Object.values(ACT_NAME_ADJECTIVES);\n  const nouns = Object.values(ACT_NAME_NOUNS);\n  const group = new Map<string, ActNameLookup>();\n  const solo = new Map<string, ActNameLookup>();\n  adjectives.forEach((adjective) => {\n    nouns.forEach((noun) => {\n      const groupName = joinParts([adjective.ko.hangul, noun.ko.p.hangul]);\n      if (!group.has(groupName)) {\n        group.set(groupName, {\n          translation: joinParts([adjective.en, noun.en.p]),\n          romanized: joinParts([adjective.ko.rr, noun.ko.p.rr])\n        });\n      }\n      const soloName = joinParts([adjective.ko.hangul, noun.ko.s.hangul]);\n      if (!solo.has(soloName)) {\n        solo.set(soloName, {\n          translation: joinParts([adjective.en, noun.en.s]),\n          romanized: joinParts([adjective.ko.rr, noun.ko.s.rr])\n        });\n      }\n    });\n  });\n  return { group, solo };\n};\n\nconst ACT_NAME_LOOKUP = buildActNameLookup();\n\nexport const lookupActNameDetails = ({\n  name,\n  nameKey,\n  actKind\n}: {\n  name: string;\n  nameKey?: string | null;\n  actKind?: ActKind | string;\n}) => {\n  const raw = String(name || \"\").trim();\n  if (!raw || !hasHangulText(raw)) {\n    return { translation: \"\", romanized: \"\" };\n  }\n  const hintKind = normalizeActKind(actKind);\n  let resolvedKind = hintKind;\n  if (nameKey) {\n    if (actKind == null) {\n      const normalizedRaw = raw.replace(/\\s+/g, \" \").trim();\n      const soloName = renderActNameKorean(nameKey, \"solo\");\n      const groupName = renderActNameKorean(nameKey, \"group\");\n      if (normalizedRaw === soloName) {\n        resolvedKind = \"solo\";\n      } else if (normalizedRaw === groupName) {\n        resolvedKind = \"group\";\n      }\n    }\n    const translation = renderActNameEnglish(nameKey, resolvedKind);\n    const romanized = renderActNameKoreanRomanized(nameKey, resolvedKind);\n    return { translation, romanized };\n  }\n  const lookup = resolvedKind === \"solo\" ? ACT_NAME_LOOKUP.solo : ACT_NAME_LOOKUP.group;\n  const fallback = resolvedKind === \"solo\" ? ACT_NAME_LOOKUP.group : ACT_NAME_LOOKUP.solo;\n  const entry = lookup.get(raw) || fallback.get(raw);\n  if (entry) return entry;\n  return { translation: \"\", romanized: romanizeHangul(raw) };\n};\n"]}