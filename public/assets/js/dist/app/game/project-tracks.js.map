{"version":3,"file":"project-tracks.js","sourceRoot":"","sources":["../../../../../src/app/game/project-tracks.ts"],"names":[],"mappings":"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","sourcesContent":["// @ts-nocheck\nconst PROJECT_TRACK_LIMITS = {\n  Single: { min: 1, max: 4 },\n  EP: { min: 5, max: 7 },\n  Album: { min: 8, max: 32 }\n};\n\nconst PROJECT_TYPE_ALIASES = {\n  single: \"Single\",\n  singles: \"Single\",\n  ep: \"EP\",\n  \"e.p.\": \"EP\",\n  album: \"Album\",\n  lp: \"Album\",\n  \"long play\": \"Album\"\n};\n\nfunction normalizeProjectType(projectType) {\n  const raw = String(projectType || \"\").trim();\n  if (!raw) return \"Single\";\n  const key = raw.toLowerCase();\n  return PROJECT_TYPE_ALIASES[key] || (PROJECT_TRACK_LIMITS[raw] ? raw : \"Single\");\n}\n\nfunction normalizeProjectName(projectName) {\n  return String(projectName || \"\").replace(/\\s+/g, \" \").trim().toLowerCase();\n}\n\nfunction getProjectTrackLimits(projectType) {\n  const normalizedType = normalizeProjectType(projectType);\n  const limits = PROJECT_TRACK_LIMITS[normalizedType] || PROJECT_TRACK_LIMITS.Single;\n  return { ...limits, type: normalizedType };\n}\n\nfunction listProjectTracks(tracks, projectName) {\n  const normalizedName = normalizeProjectName(projectName);\n  if (!normalizedName) return [];\n  const pool = Array.isArray(tracks) ? tracks : [];\n  return pool.filter((track) => normalizeProjectName(track.projectName) === normalizedName);\n}\n\nfunction evaluateProjectTrackConstraints(tracks, projectName, projectType) {\n  const normalizedType = normalizeProjectType(projectType);\n  const limits = getProjectTrackLimits(normalizedType);\n  const normalizedName = normalizeProjectName(projectName);\n  if (!normalizedName) {\n    return { ok: true, normalizedType, limits, count: 0, existingTypes: [] };\n  }\n  const matched = listProjectTracks(tracks, projectName);\n  const count = matched.length;\n  const existingTypes = Array.from(new Set(matched.map((track) => normalizeProjectType(track.projectType))));\n  const conflict = existingTypes.find((type) => type !== normalizedType);\n  if (conflict) {\n    return {\n      ok: false,\n      normalizedType,\n      limits,\n      count,\n      existingTypes,\n      reason: `Project \"${projectName}\" already uses ${conflict} tracks. Use ${conflict} or rename the project.`\n    };\n  }\n  if (Number.isFinite(limits.max) && count >= limits.max) {\n    return {\n      ok: false,\n      normalizedType,\n      limits,\n      count,\n      existingTypes,\n      reason: `${normalizedType} projects cap at ${limits.max} tracks. \"${projectName}\" already has ${count}.`\n    };\n  }\n  return { ok: true, normalizedType, limits, count, existingTypes };\n}\n\nexport {\n  getProjectTrackLimits,\n  normalizeProjectName,\n  normalizeProjectType,\n  evaluateProjectTrackConstraints\n};\n"]}